!function(e){function t(t){for(var n,a,s=t[0],c=t[1],u=t[2],f=0,p=[];f<s.length;f++)a=s[f],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);for(l&&l(t);p.length;)p.shift()();return i.push.apply(i,u||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,s=1;s<r.length;s++){var c=r[s];0!==o[c]&&(n=!1)}n&&(i.splice(t--,1),e=a(a.s=r[0]))}return e}var n={},o={0:0},i=[];function a(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=n,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;i.push([225,1]),r()}({204:function(e,t){},222:function(e,t){},223:function(e,t){},224:function(e,t){},225:function(e,t,r){"use strict";r.r(t);r(85),r(70),r(95),r(96);var n=r(1),o=r(11),i=r.n(o),a=(r(57),r(28),r(101),r(75),r(104),r(19),r(79),r(155),r(109),r(29),r(110),r(111),r(112),r(20),r(25),r(81),r(30),r(160),r(133)),s=r.n(a),c=r(134),u=r.n(c),l=r(135),f=r.n(l),p=r(136),h=r.n(p),d=r(137),b=r.n(d),w=r(138),y=r(145),g=r(139);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach(function(t){O(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function x(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var P=0;function S(e){return"__private_"+P+++"_"+e}var E=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.background,a=void 0===o?"#000":o,c=r.backgroundAlpha,l=void 0===c?1:c,f=r.fov,p=void 0===f?45:f,d=r.near,m=void 0===d?.01:d,O=r.far,j=void 0===O?100:O,P=k(r,["background","backgroundAlpha","fov","near","far"]);if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,C,{writable:!0,value:[]}),Object.defineProperty(this,T,{writable:!0,value:new n.Hb}),Object.defineProperty(this,D,{writable:!0,value:void 0}),Object.defineProperty(this,R,{writable:!0,value:void 0}),this.resize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.width,n=void 0===r?window.innerWidth:r,o=e.height,i=void 0===o?window.innerHeight:o,a=e.pixelRatio,s=void 0===a?Math.min(t.maxPixelRatio,window.devicePixelRatio):a;return t.width=n,t.height=i,t.pixelRatio=s,t.renderer.getPixelRatio()!==s&&t.renderer.setPixelRatio(s),t.renderer.setSize(n,i),t.camera.isPerspectiveCamera&&(t.camera.aspect=n/i),t.camera.updateProjectionMatrix(),t.composer&&t.composer.setSize(s*n,s*i),t.scene.traverse(function(e){"function"==typeof e.resize&&e.resize({width:n,height:i,pixelRatio:s})}),t.draw(),t},this.saveScreenshot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.width,n=void 0===r?2560:r,o=e.height,i=void 0===o?1440:o,a=e.fileName,s=void 0===a?"image.png":a;t.resize({width:n,height:i,pixelRatio:1}),t.draw();var c=t.canvas.toDataURL("image/png");t.resize(),t.draw(),_(s,c)},this.update=function(e,r){return t.orbitControls&&(t.orbitControls.update(),t.camera.up.fromArray(t.orbitControls.up),t.camera.position.fromArray(t.orbitControls.position),x(t,T)[T].fromArray(t.orbitControls.target),t.camera.lookAt(x(t,T)[T])),t.scene.traverse(function(t){"function"==typeof t.update&&t.update(e,r)}),t.world&&(t.world.step(e),t.world.bodies.forEach(function(t){"function"==typeof t.update&&t.update(e,r)})),t.tween&&t.tween.update(),x(t,C)[C].forEach(function(t){return t(e,r)}),t},this.draw=function(){return t.composer?(t.composer.passes.forEach(function(e,t,r){var n=t===r.length-1;e.renderToScreen=!!n}),t.composer.render()):t.renderer.render(t.scene,t.camera),t},this.start=function(){if(null===x(t,D)[D])return x(t,D)[D]=window.requestAnimationFrame(t.animate),t.isRunning=!0,t},this.stop=function(){if(null!==x(t,D)[D])return window.cancelAnimationFrame(x(t,D)[D]),x(t,D)[D]=null,t.isRunning=!1,t},this.animate=function(){if(t.isRunning){window.requestAnimationFrame(t.animate),t.stats&&t.stats.begin();var e=performance.now(),r=Math.min(t.maxDeltaTime,(e-x(t,R)[R])/1e3);t.time+=r,x(t,R)[R]=e,t.update(r,t.time),t.draw(),t.stats&&t.stats.end()}},this.traverse=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];t.scene.traverse(function(t){"function"==typeof t[e]&&t[e].apply(t,n)})},this.renderer=new n.Mb(v({antialias:!0,alpha:!1,preserveDrawingBuffer:!0,failIfMajorPerformanceCaveat:!0},P)),this.renderer.sortObjects=!1,this.canvas=this.renderer.domElement,this.renderer.setClearColor(a,l),this.maxPixelRatio=P.maxPixelRatio||2,this.maxDeltaTime=P.maxDeltaTime||1/30,this.camera=new n.eb(p,1,m,j),this.scene=new n.tb,this.gl=this.renderer.getContext(),this.time=0,this.isRunning=!1,x(this,R)[R]=performance.now(),x(this,D)[D]=null,window.addEventListener("resize",this.resize),window.addEventListener("orientationchange",this.resize),this.resize(),this.touchHandler=u()(this.canvas,{target:this.canvas,filtered:!0}),this.touchHandler.on("start",function(e,r){return t.traverse("onPointerDown",e,r)}),this.touchHandler.on("move",function(e,r){return t.traverse("onPointerMove",e,r)}),this.touchHandler.on("end",function(e,r){return t.traverse("onPointerUp",e,r)}),P.postprocessing&&(this.composer=new y.a(this.renderer),this.composer.addPass(new g.a(this.scene,this.camera))),P.orbitControls&&(this.orbitControls=s()(v({element:this.canvas,parent:window,distance:5},P.orbitControls instanceof Object?P.orbitControls:{})),this.camera.position.fromArray(this.orbitControls.position),this.camera.lookAt((new n.Hb).fromArray(this.orbitControls.target))),P.world&&(this.world=P.world),P.tween&&(this.tween=P.tween),P.showFps&&(this.stats=new h.a,this.stats.showPanel(0),document.body.appendChild(this.stats.dom)),P.controls){var S=i()(P.controls);if(this.controls=P.hideControls?S:b()(S),P.closeControls){var E=document.querySelector('[class*="controlPanel"]');E.style.display="none",document.querySelector('[class*="controlPanel"] button').click(),E.style.display="block"}}var B=Object(w.getGPUTier)({glContext:this.renderer.getContext()});this.gpu={name:B.type,tier:Number(B.tier.slice(-1)),isMobile:B.tier.toLowerCase().includes("mobile")}}var t,r,o;return t=e,(r=[{key:"onUpdate",value:function(e){x(this,C)[C].push(e)}}])&&j(t.prototype,r),o&&j(t,o),e}(),C=S("updateListeners"),T=S("tmpTarget"),D=S("rafID"),R=S("lastTime");function _(e,t){var r=f()(t),n=document.createElement("a");n.download=e,n.href=window.URL.createObjectURL(r),n.onclick=setTimeout(function(){window.URL.revokeObjectURL(r),n.removeAttribute("href")},0),n.click()}r(34),r(35),r(124),r(189),r(190),r(191),r(126),r(55),r(130),r(56);var B=r(140),M=r.n(B),L=r(60),A=r.n(L),q=r(58),U=r(141);r(131),r(206);function H(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function z(e,t){return I.apply(this,arguments)}function I(){var e;return e=regeneratorRuntime.mark(function e(t,r){var o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new n.Ab).name=t,o.encoding=r.encoding||n.I,F(t,o,r),e.prev=4,e.next=7,Object(q.a)(t,{crossorigin:"anonymous"});case 7:return i=e.sent,o.image=i,o.needsUpdate=!0,r.renderer&&r.renderer.initTexture(o),e.abrupt("return",o);case 14:throw e.prev=14,e.t0=e.catch(4),new Error("Could not load texture ".concat(t));case 17:case"end":return e.stop()}},e,null,[[4,14]])}),(I=function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){H(i,n,o,a,s,"next",e)}function s(e){H(i,n,o,a,s,"throw",e)}a(void 0)})}).apply(this,arguments)}function F(e,t,r){if("boolean"==typeof r.flipY&&(t.flipY=r.flipY),void 0!==r.mapping&&(t.mapping=r.mapping),void 0!==r.format)t.format=r.format;else{var o=e.search(/\.(jpg|jpeg)$/)>0||0===e.search(/^data:image\/jpeg/);t.format=o?n.pb:n.mb}r.repeat&&t.repeat.copy(r.repeat),t.wrapS=r.wrapS||n.i,t.wrapT=r.wrapT||n.i,t.minFilter=r.minFilter||n.K,t.magFilter=r.magFilter||n.J,t.generateMipmaps=!1!==r.generateMipmaps}r(208);var V=r(142),Y=r.n(V),G=r(146),W=r(143),X=r(144);function $(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function K(e,t){return J.apply(this,arguments)}function J(){var e;return e=regeneratorRuntime.mark(function e(t,r){var o,i,a,s,c,u,l,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.renderer){e.next=3;break}throw new Error("PBR Map requires renderer to passed in the options for ".concat(t,"!"));case 3:if(!r.equirectangular){e.next=13;break}return e.next=6,z(t,{renderer:o});case 6:return i=e.sent,a=new n.Lb(1024,1024).fromEquirectangularTexture(o,i),(s=a.texture).renderTarget=a,i.dispose(),i.image.data=null,e.abrupt("return",N(s,r));case 13:if(c=t,u=r.hdr,l=u?".hdr":".png",p="".concat(c.replace(/\/$/,""),"/"),h=l,f=["".concat(p,"px").concat(h),"".concat(p,"nx").concat(h),"".concat(p,"py").concat(h),"".concat(p,"ny").concat(h),"".concat(p,"pz").concat(h),"".concat(p,"nz").concat(h)],!u){e.next=19;break}return e.abrupt("return",new Promise(function(e,t){(new G.a).load(n.Fb,f,function(t){return e(N(t,r))},null,function(){return t(new Error("Could not load PBR map: ".concat(c)))})}));case 19:return e.abrupt("return",new Promise(function(e,t){(new n.m).load(f,function(t){t.encoding=n.qb,e(N(t,r))},null,function(){return t(new Error("Could not load PBR map: ".concat(c)))})}));case 20:case"end":return e.stop()}var p,h},e)}),(J=function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){$(i,n,o,a,s,"next",e)}function s(e){$(i,n,o,a,s,"throw",e)}a(void 0)})}).apply(this,arguments)}function N(e,t){if(t.pbr||"number"==typeof t.level){var r=new W.a(e);if(r.update(t.renderer),t.pbr){var n=new X.a(r.cubeLods);n.update(t.renderer),e=n.CubeUVRenderTarget.texture,n.dispose()}else{var o=Y()(Math.floor(t.level),0,r.cubeLods.length);e=r.cubeLods[o].texture}r.dispose()}return t.mapping&&(e.mapping=t.mapping),e}function Q(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Z(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function ee(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Z(i,n,o,a,s,"next",e)}function s(e){Z(i,n,o,a,s,"throw",e)}a(void 0)})}}function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach(function(t){ne(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oe(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function ie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ae(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var se=0;function ce(e){return"__private_"+se+++"_"+e}var ue=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,le,{writable:!0,value:[]}),Object.defineProperty(this,fe,{writable:!0,value:{}}),Object.defineProperty(this,pe,{writable:!0,value:[]}),Object.defineProperty(this,he,{writable:!0,value:10}),Object.defineProperty(this,de,{writable:!0,value:[]}),this.get=function(e){if(!e)throw new TypeError("Must specify an URL for AssetManager.get()");if(!(e in ae(t,fe)[fe]))throw new Error("The asset ".concat(e," is not in the loaded files."));return ae(t,fe)[fe][e]}}var t,r,n,o,i,a;return t=e,(r=[{key:"addProgressListener",value:function(e){if("function"!=typeof e)throw new TypeError("onProgress must be a function");ae(this,pe)[pe].push(e)}},{key:"queue",value:function(e){var t=e.url,r=e.type,n=oe(e,["url","type"]);if(!t)throw new TypeError("Must specify a URL or opt.url for AssetManager.queue()");return this._getQueued(t)||ae(this,le)[le].push(re({url:t,type:r||this._extractType(t)},n)),t}},{key:"_getQueued",value:function(e){return ae(this,le)[le].find(function(t){return t.url===e})}},{key:"_extractType",value:function(e){var t=e.slice(e.lastIndexOf("."));switch(!0){case/\.(gltf|glb)$/i.test(t):return"gltf";case/\.json$/i.test(t):return"json";case/\.svg$/i.test(t):return"svg";case/\.(jpe?g|png|gif|bmp|tga|tif)$/i.test(t):return"image";case/\.(wav|mp3)$/i.test(t):return"audio";case/\.(mp4|webm|ogg|ogv)$/i.test(t):return"video";default:throw new Error("Could not load ".concat(e,", unknown file extension!"))}}},{key:"loadSingle",value:(a=ee(regeneratorRuntime.mark(function e(t){var r,n,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.renderer,n=oe(t,["renderer"]),r){e.next=3;break}throw new Error("You must provide a renderer to the loadSingle function.");case 3:return e.prev=3,o=Date.now(),e.next=7,this._loadItem(re({renderer:r},n));case 7:return ae(this,fe)[fe][n.url]=e.sent,window.DEBUG&&console.log("\ud83d\udce6 Loaded single asset %c".concat(n.url,"%c in ").concat(A()(Date.now()-o)),"color:blue","color:black"),e.abrupt("return",n.url);case 12:e.prev=12,e.t0=e.catch(3),delete ae(this,fe)[fe][n.url],console.error("\ud83d\udce6  Could not load ".concat(n.url,":\n").concat(e.t0));case 16:case"end":return e.stop()}},e,this,[[3,12]])})),function(e){return a.apply(this,arguments)})},{key:"load",value:(i=ee(regeneratorRuntime.mark(function e(t){var r,n,o,i,a,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.renderer){e.next=3;break}throw new Error("You must provide a renderer to the load function.");case 3:if(n=ae(this,le)[le].slice(),ae(this,le)[le].length=0,0!==(o=n.length)){e.next=9;break}return setTimeout(function(){return ae(s,pe)[pe].forEach(function(e){return e(1)})},0),e.abrupt("return");case 9:return i=Date.now(),e.next=12,M()(n,function(){var e=ee(regeneratorRuntime.mark(function e(t,n){var i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i=Date.now(),e.next=4,s._loadItem(re({renderer:r},t));case 4:ae(s,fe)[fe][t.url]=e.sent,window.DEBUG&&s.log("Loaded %c".concat(t.url,"%c in ").concat(A()(Date.now()-i)),"color:blue","color:black"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),s.logError("Skipping ".concat(t.url," from asset loading:\n").concat(e.t0));case 11:a=(n+1)/o,ae(s,pe)[pe].forEach(function(e){return e(a)});case 13:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,r){return e.apply(this,arguments)}}(),{concurrency:ae(this,he)[he]});case 12:window.DEBUG&&(a=ae(this,de)[de].filter(function(e){return"error"===e.type}),this.groupLog("\ud83d\udce6 Assets loaded in ".concat(A()(Date.now()-i)," \u23f1 ").concat(a.length>0?"%c \u26a0\ufe0f Skipped ".concat(a.length," asset").concat(a.length>1?"s":""," "):""),a.length>0?"color:white;background:red;":""));case 13:case"end":return e.stop()}},e,this)})),function(e){return i.apply(this,arguments)})},{key:"_loadItem",value:(o=ee(regeneratorRuntime.mark(function e(t){var r,n,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.url,n=t.type,o=t.renderer,i=oe(t,["url","type","renderer"]),!(r in ae(this,fe)[fe])){e.next=3;break}return e.abrupt("return",ae(this,fe)[fe][r]);case 3:e.t0=n,e.next="gltf"===e.t0?6:"json"===e.t0?7:"env-map"===e.t0?8:"svg"===e.t0?9:"image"===e.t0?9:"texture"===e.t0?10:"audio"===e.t0?11:"video"===e.t0?12:13;break;case 6:return e.abrupt("return",new Promise(function(e,t){(new U.a).load(r,e,null,function(e){return t(new Error("Could not load GLTF asset ".concat(r,":\n").concat(e)))})}));case 7:return e.abrupt("return",fetch(r).then(function(e){return e.json()}));case 8:return e.abrupt("return",K(r,re({renderer:o},i)));case 9:return e.abrupt("return",Object(q.a)(r,{crossorigin:"anonymous"}));case 10:return e.abrupt("return",z(r,re({renderer:o},i)));case 11:return e.abrupt("return",fetch(r).then(function(e){return e.arrayBuffer()}));case 12:return e.abrupt("return",fetch(r).then(function(e){return e.blob()}));case 13:throw new Error("Could not load ".concat(r,", the type ").concat(n," is unknown!"));case 14:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];ae(this,de)[de].push({type:"log",text:t})}},{key:"logError",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];ae(this,de)[de].push({type:"error",text:t})}},{key:"groupLog",value:function(){var e;(e=console).groupCollapsed.apply(e,arguments),ae(this,de)[de].forEach(function(e){var t;(t=console)[e.type].apply(t,Q(e.text))}),console.groupEnd(),ae(this,de)[de].length=0}}])&&ie(t.prototype,r),n&&ie(t,n),e}(),le=ce("queue"),fe=ce("cache"),pe=ce("onProgressListeners"),he=ce("asyncConcurrency"),de=ce("logs"),be=new ue,we=be.queue({url:"assets/ouside-afternoon-blurred-hdr.jpg",type:"env-map",equirectangular:!0});r(42),r(43);function ye(e){return(ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ge(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function me(e,t){return!t||"object"!==ye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ve(e){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oe(e,t){return(Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ke=function(e){function t(e,r){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=me(this,ve(t).call(this,r))).webgl=e,o.options=r;var i=o.options,a=i.width,s=void 0===a?1:a,c=i.height,u=void 0===c?1:c,l=i.depth,f=void 0===l?1:l,p=i.widthSegments,h=void 0===p?1:p,d=i.heightSegments,b=void 0===d?1:d,w=i.depthSegments,y=void 0===w?1:w,g=i.color,m=void 0===g?16777215:g;return o.box=new n.T(new n.e(s,u,f,h,b,y),new n.U({color:m,wireframe:!0})),o.calibrationMarkers=new n.w,o.greenCircle=new n.T(new n.h(.01,20,0,2*Math.PI),new n.U({color:65280})),o.greenCircle.position.set(0,0,.5*f-.01),o.redCircle=new n.T(new n.h(.01,20,0,2*Math.PI),new n.U({color:16711680})),o.redCircle.position.set(0,0,.5*-f),o.greenSquare=new n.T(new n.gb(.02,.02,1,1),new n.U({color:65280})),o.greenSquare.position.set(.5*-s,0,.5*f-.01),o.redSquare=new n.T(new n.gb(.02,.02,1,1),new n.U({color:16711680})),o.redSquare.position.set(.5*-s,0,.5*-f),o.greenDiamond=new n.T(new n.gb(.02,.02,1,1),new n.U({color:65280})),o.greenDiamond.position.set(0,.5*u,.5*f-.01),o.greenDiamond.rotation.set(0,0,.25*Math.PI),o.redDiamond=new n.T(new n.gb(.02,.02,1,1),new n.U({color:16711680})),o.redDiamond.position.set(0,.5*u,.5*-f),o.redDiamond.rotation.set(0,0,.25*Math.PI),o.calibrationMarkers.add(o.greenCircle),o.calibrationMarkers.add(o.redCircle),o.calibrationMarkers.add(o.greenSquare),o.calibrationMarkers.add(o.redSquare),o.calibrationMarkers.add(o.greenDiamond),o.calibrationMarkers.add(o.redDiamond),o.add(o.box),o.add(o.calibrationMarkers),o}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oe(e,t)}(t,n["w"]),r=t,(o=[{key:"update",value:function(e,t){this.calibrationMarkers.visible=this.webgl.controls.enableCalibrationMarkers}}])&&ge(r.prototype,o),i&&ge(r,i),t}();function je(e){return(je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pe(e,t){return!t||"object"!==je(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ee(e,t){return(Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ce=function(e){function t(e,r,n){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Pe(this,Se(t).call(this,r))).webgl=e,o.options=r,o.faceTracker=n,function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}(o.options),o.position.set(n.position.x,n.position.y,n.position.z),e.camera.position.set(o.position.x,o.position.y,o.position.z),o}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ee(e,t)}(t,n["w"]),r=t,(o=[{key:"update",value:function(e,t){var r=window.innerHeight/window.innerWidth,o=new n.Hb(this.faceTracker.position.x,this.faceTracker.position.y,this.faceTracker.position.z);this.webgl.camera.position.set(o.x,o.y,o.z),this.position.set(o.x,o.y,o.z),this.webgl.camera.near=o.z+.001,this.webgl.camera.setViewOffset(1,r,-o.x,o.y,1,r),this.webgl.camera.fov=n.R.radToDeg(2*Math.atan(r/(2*o.z)))}}])&&xe(r.prototype,o),i&&xe(r,i),t}(),Te=r(16);function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Re(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function _e(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){Re(i,n,o,a,s,"next",e)}function s(e){Re(i,n,o,a,s,"throw",e)}a(void 0)})}}function Be(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Me(e,t){return!t||"object"!==De(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Le(e){return(Le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(e,t){return(Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qe=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Me(this,Le(t).call(this,r))).webgl=e,n.options=r,n.debugElement=document.getElementById("face-tracker"),n.webcamVideo=document.getElementById("webcam-video"),n.webcamCanvas=document.getElementById("face-tracker-debug"),n.webcamVideo.setAttribute("width",n.webgl.canvas.clientWidth),n.webcamVideo.setAttribute("height",n.webgl.canvas.clientHeight),n.position.setZ(1),n}var r,o,i,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(t,n["w"]),r=t,(o=[{key:"setup",value:(s=_e(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!0});case 2:return t=e.sent,this.webcamVideo.srcObject=t,e.next=6,Te.f("/models/tiny_face_detector");case 6:return e.next=8,Te.e("/models/face_landmark_68_tiny");case 8:this.detectorOptions=new Te.b,this.updateTracking();case 10:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})},{key:"updateDebug",value:function(){var e=this.webgl.controls.debugFaceTracker;if(this.debugElement.style=e?"visibility: visible":"visibility: hidden",e){if(this.debugElement.style="visibility: visible",this.webcamCanvas.width=this.webcamVideo.width,this.webcamCanvas.height=this.webcamVideo.height,this.detection){var t=Te.g(this.detection,{width:this.webcamVideo.width,height:this.webcamVideo.height});Te.d.drawDetections(this.webcamCanvas,t),Te.d.drawFaceLandmarks(this.webcamCanvas,t);var r=this.extractDetectionData(t),n=this.webcamCanvas.getContext("2d");n.fillStyle="#00ff00",n.fillRect(r.eyeLeft.x,r.eyeLeft.y,5,5),n.fillRect(r.eyeRight.x,r.eyeRight.y,5,5),n.fillRect(r.eyeMiddle.x,r.eyeMiddle.y,10,10)}}else this.debugElement.style="visibility: hidden"}},{key:"runDetectionTask",value:function(){return Te.c(this.webcamVideo,this.detectorOptions).withFaceLandmarks(!0)}},{key:"avgLandmark",value:function(e){if(0==e.length)return new Te.a(0,0);var t=0,r=0;return e.forEach(function(e){t+=e.x,r+=e.y}),t/=e.length,r/=e.length,new Te.a(t,r)}},{key:"extractDetectionData",value:function(e){var t=this.avgLandmark(e.landmarks.getLeftEye()),r=this.avgLandmark(e.landmarks.getRightEye());return{eyeLeft:t,eyeRight:r,eyeMiddle:this.avgLandmark([t,r]),faceArea:e.detection.box.area}}},{key:"computeWorldPosition",value:function(){if(this.detection){localStorage.depthBias=this.webgl.controls.depthBias,localStorage.widthBias=this.webgl.controls.widthBias,localStorage.heightBias=this.webgl.controls.heightBias,localStorage.offsetXBias=this.webgl.controls.offsetXBias,localStorage.offsetYBias=this.webgl.controls.offsetYBias,this.rawDataHistory||(this.rawDataHistory=[]),this.rawDataHistory.push(this.extractDetectionData(this.detection)),this.rawDataHistory=this.rawDataHistory.slice(Math.max(this.rawDataHistory.length-5,0));var e=0,t=0,r=0;this.rawDataHistory.forEach(function(n){e+=n.faceArea,t+=n.eyeMiddle.x,r+=n.eyeMiddle.y}),e/=this.rawDataHistory.length,t/=this.rawDataHistory.length,r/=this.rawDataHistory.length,t=(-t+this.webgl.controls.offsetXBias)/this.webgl.controls.widthBias,r=(-r+this.webgl.controls.offsetYBias)/this.webgl.controls.heightBias,this.position.setZ(this.webgl.controls.depthBias/Math.sqrt(e)),this.position.setX(t),this.position.setY(r)}}},{key:"updateTracking",value:(a=_e(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.runDetectionTask();case 2:this.detection=e.sent,this.detection&&(this.computeWorldPosition(),this.updateDebug()),window.requestAnimationFrame(this.updateTracking.bind(this));case 5:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)})}])&&Be(r.prototype,o),i&&Be(r,i),t}();function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function He(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ie(e,t){return!t||"object"!==Ue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fe(e){return(Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ve(e,t){return(Ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ye=be.queue({url:"assets/suzanne.gltf",type:"gltf"}),Ge=be.queue({url:"assets/spotty-metal/albedo.jpg",type:"texture"}),We=be.queue({url:"assets/spotty-metal/metalness.jpg",type:"texture"}),Xe=be.queue({url:"assets/spotty-metal/roughness.jpg",type:"texture"}),$e=be.queue({url:"assets/spotty-metal/normal.jpg",type:"texture"}),Ke=be.queue({url:"assets/ouside-afternoon-blurred-hdr.jpg",type:"env-map",equirectangular:!0}),Je=function(e){function t(e,r){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Ie(this,Fe(t).call(this,r))).webgl=e,o.options=r;var i=be.get(Ye).scene.clone(),a=new n.V({map:be.get(Ge),metalnessMap:be.get(We),roughnessMap:be.get(Xe),normalMap:be.get($e),normalScale:new n.Gb(2,2),envMap:be.get(Ke),roughness:.5,metalness:.8});return i.traverse(function(e){e.isMesh&&(e.material=a)}),i.scale.multiplyScalar(.1),o.add(i),o.webgl.scene.background=be.get(Ke).renderTarget,o}var r,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ve(e,t)}(t,n["w"]),r=t,(o=[{key:"onPointerDown",value:function(e,t){var r=He(t,2),o=r[0],i=r[1],a=(new n.Gb).set(o/this.webgl.width*2-1,-i/this.webgl.height*2+1),s=new n.rb;s.setFromCamera(a,this.webgl.camera);var c=s.intersectObject(this,!0);console.log(c.length>0?"Hit ".concat(c[0].object.name,"!"):"No hit")}},{key:"onPointerMove",value:function(e,t){var r=He(t,2);r[0],r[1]}},{key:"onPointerUp",value:function(e,t){var r=He(t,2);r[0],r[1]}},{key:"update",value:function(e,t){this.rotation.y+=e*this.webgl.controls.angularVelocity}}])&&ze(r.prototype,o),i&&ze(r,i),t}();window.DEBUG=window.location.search.includes("debug");var Ne=new E({canvas:document.getElementById("app"),alpha:!0,background:"#000",backgroundAlpha:1,showFps:window.DEBUG,postprocessing:!0,orbitControls:window.DEBUG&&{distance:5},controls:{Instructions:{instructions:i.a.Raw(function(e){return e("p",null,'\n        Hello! This is just a prototype of a face-tracking camera.\n        If this is the first time you are watching this demo,\n        please follow the instructions in order to calibrate the\n        face-tracking system. When you are finished you can close\n        this popup by clicking on "controls".\n      ')}),"Step 1 - Calibrate Face Offset":{instructions:i.a.Raw(function(e){return e("p",null,'\n          Enable the calibration markers.\n          Keep your face still in front of the green circle,\n          then adjust "OffsetX Bias" and "OffsetY Bias" until the\n          red circle completely disappears behind the green circle\n        ')})},"Step 2 - Calibrate webcam/viewport width":{instructions:i.a.Raw(function(e){return e("p",null,'\n          Keep your face still in front of the green square,\n          then adjust "Width Bias" until the red square completely\n          disappears behind the green square\n        ')})},"Step 3 - Calibrate webcam/viewport height":{instructions:i.a.Raw(function(e){return e("p",null,'\n          Keep your face still in front of the green triangle,\n          then adjust "Height Bias" until the red triangle completely\n          disappears behind the green triangle\n        ')})},"Step 4 - Calibrate webcam/viewport depth":{instructions:i.a.Raw(function(e){return e("p",null,'\n          Keep your face still in front of the green circle,\n          then adjust "Depth Bias" until you feel that the depth\n          of the box is equal to the width of your screen.\n          Disable the calibration markers.\n        ')})}},enableCalibrationMarkers:!1,offsetXBias:i.a.Slider(+localStorage.offsetXBias||0,{label:"OffsetX Bias",min:0,max:4096,step:.01}),offsetYBias:i.a.Slider(+localStorage.offsetYBias||0,{label:"OffsetY Bias",min:0,max:4096,step:.01}),widthBias:i.a.Slider(+localStorage.widthBias||4096,{label:"Width Bias",min:1,max:4096,step:.01}),heightBias:i.a.Slider(+localStorage.heightBias||4096,{label:"Height Bias",min:1,max:4096,step:.01}),depthBias:i.a.Slider(+localStorage.depthBias||1e3,{label:"Depth Bias",min:1,max:1e3,step:.01}),debugFaceTracker:i.a.Checkbox(!1,{label:"Debug Face Tracker"}),resetCalibration:function(){Ne.controls={},localStorage.clear(),window.location.reload()}}});window.DEBUG&&(window.webgl=Ne),Ne.canvas.style.visibility="hidden",be.load({renderer:Ne.renderer}).then(function(){return Ne.scene.faceTracker=new qe(Ne,{}),Ne.scene.faceTracker.setup()}).then(function(){Ne.canvas.style.visibility="",Ne.scene.add(Ne.scene.faceTracker),Ne.scene.offCenterCamera=new Ce(Ne,{},Ne.scene.faceTracker),Ne.scene.add(Ne.scene.offCenterCamera),Ne.scene.box=new ke(Ne,{width:1,height:Ne.canvas.clientHeight/Ne.canvas.clientWidth,depth:1,widthSegments:10,heightSegments:10,depthSegments:10,color:16777215}),Ne.scene.box.position.z=-.5,Ne.scene.add(Ne.scene.box),Ne.scene.suzanne=new Je(Ne,{}),Ne.scene.add(Ne.scene.suzanne),Ne.scene.background=be.get(we).renderTarget,function(e){var t=new n.y(16777215,16777215,.6);t.color.setHSL(.6,1,.6),t.groundColor.setHSL(.095,1,.75),t.position.set(0,50,0),e.scene.add(t);var r=new n.q(16777215,1);r.color.setHSL(.1,1,.95),r.position.set(3,5,1),r.position.multiplyScalar(50),e.scene.add(r)}(Ne),window.DEBUG&&function(e){var t=document.createElement("div");t.style.position="fixed",t.style.bottom=0,t.style.right=0,t.style.background="tomato",t.style.cursor="pointer",t.style.padding="8px 16px",t.style.color="white",t.style.fontSize="24px",t.textContent="Save screenshot",document.body.appendChild(t),t.addEventListener("click",e.saveScreenshot)}(Ne),Ne.start(),Ne.draw()})}});
//# sourceMappingURL=app.28de637b.js.map